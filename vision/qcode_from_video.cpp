#pragma hdrstop
#include "qcode_lib.h"
#include "qcode_std.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)

IplImage* frame =0;

int main(int argc, char* argv[])
{
        // ??? ????? ???????? ?????? ??????????
        char* filename = argc == 2 ? argv[1] : "test.avi";

        printf("[i] file: %s\n", filename);

        // ???? ??? ??????????? ????????
        cvNamedWindow("original",CV_WINDOW_AUTOSIZE);

        // ???????? ?????????? ? ?????-?????
        CvCapture* capture = cvCreateFileCapture( filename );

        while(1){
                // ???????? ????????? ????
                frame = cvQueryFrame( capture ); 
                if( !frame ) {
                        break;
                }

                // ????? ????? ????????
                // ????????? ?????????

                // ?????????? ????
                cvShowImage( "original", frame );

                char c = cvWaitKey(33);
                if (c == 27) { // ???? ?????? ESC - ???????
                        break;
                }
        }

        // ??????????? ???????
        cvReleaseCapture( &capture );
        // ??????? ????
        cvDestroyWindow("original");
        return 0;
}